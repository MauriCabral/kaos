<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<AnchorPane stylesheets="@../css/order-history.css" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.kaos.controller.OrderHistoryController">

    <VBox spacing="15" styleClass="container" AnchorPane.bottomAnchor="15" AnchorPane.leftAnchor="15" AnchorPane.rightAnchor="15" AnchorPane.topAnchor="15">

        <!-- PANEL SUPERIOR -->
        <HBox alignment="CENTER_LEFT" spacing="10" styleClass="title-bar">
            <Label styleClass="compact-title" text="HistÃ³rico de Pedidos" />
            <Region HBox.hgrow="ALWAYS" />
            <TextField fx:id="searchField" prefWidth="200" promptText="Buscar..." styleClass="compact-search-field" />
            <Button fx:id="searchBtn" onAction="#handleSearch" styleClass="compact-search-btn" text="Buscar" />
        </HBox>

        <!-- FILTROS -->
        <HBox fx:id="filterContainer" alignment="CENTER_LEFT" spacing="10" styleClass="compact-filter-container">
            <CheckBox fx:id="deliveryCheck" styleClass="compact-checkbox" text="Delivery" />
            <CheckBox fx:id="pickupCheck" styleClass="compact-checkbox" text="Recoge" />
            <CheckBox fx:id="cashCheck" styleClass="compact-checkbox" text="Efectivo" />
            <CheckBox fx:id="transferCheck" styleClass="compact-checkbox" text="Transferencia" />
            <CheckBox fx:id="todayCheck" styleClass="compact-checkbox" text="Hoy" />

            <Region HBox.hgrow="ALWAYS" />

            <Label styleClass="filter-label" text="Desde:" />
            <DatePicker fx:id="dateFromPicker" prefWidth="110" promptText="dd/mm/aaaa" styleClass="compact-date-filter" />

            <Label styleClass="filter-label" text="Hasta:" />
            <DatePicker fx:id="dateToPicker" prefWidth="110" promptText="dd/mm/aaaa" styleClass="compact-date-filter" />

            <Button fx:id="assignDeliveryBtn" onAction="#assignDeliveryToSelected" prefHeight="30" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-cursor: hand;" text="ðŸšš">
                <tooltip>
                    <Tooltip text="Asignar Delivery" />
                </tooltip>
            </Button>

            <Button fx:id="excelButtom" onAction="#orderExcel" prefHeight="30" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-cursor: hand;">
                <graphic>
                    <ImageView fitWidth="24" fitHeight="24" preserveRatio="true">
                        <Image url="@../image/Excel.png"/>
                    </ImageView>
                </graphic>
            </Button>
        </HBox>

        <!-- TABLA AGRANDADA -->
        <TableView fx:id="ordersTable" styleClass="compact-order-table" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="checkboxColumn" styleClass="compact-checkbox-column" text="" />
                <TableColumn fx:id="idColumn" styleClass="compact-id-column" text="ID" />
                <TableColumn fx:id="orderNumberColumn" styleClass="compact-order-column" text="NÂ° Pedido" />
                <TableColumn fx:id="dateColumn" styleClass="compact-date-column" text="Fecha" />
                <TableColumn fx:id="customerNameColumn" styleClass="compact-name-column" text="Cliente" />
                <!-- Telefono y DirecciÃ³n -->
                <TableColumn fx:id="customerAddressColumn" styleClass="compact-address-column" text="DirecciÃ³n" visible="false" />
                <TableColumn fx:id="customerPhoneColumn" styleClass="compact-phone-column" text="TelÃ©fono" visible="false" />
                <TableColumn fx:id="typeColumn" styleClass="compact-type-column" text="Tipo" />
                <TableColumn fx:id="storeColumn" styleClass="compact-store-column" text="Local" />
                <!-- Creador para todos -->
                <TableColumn fx:id="createdByColumn" styleClass="compact-creator-column" text="Creador" visible="false" />
                <TableColumn fx:id="paymentMethodColumn" styleClass="compact-payment-column" text="Pago" />
                <TableColumn fx:id="observationsColumn" styleClass="compact-observations-column" text="Observaciones" />
                <TableColumn fx:id="subtotalColumn" styleClass="compact-money-column" text="Subtotal" />
                <TableColumn fx:id="totalColumn" styleClass="compact-total-column" text="Total" />
                <TableColumn fx:id="actionsColumn" styleClass="compact-actions-column" text=" " />
            </columns>
        </TableView>

        <!-- CONTADORES EN LA PARTE INFERIOR -->
        <HBox alignment="CENTER" spacing="20" styleClass="counters-container">
            <!-- Total de Pedidos -->
            <VBox alignment="CENTER" spacing="3">
                <Label styleClass="counter-label" text="Total Pedidos" />
                <Label fx:id="totalOrdersLabel" styleClass="counter-value total-counter" text="0" />
            </VBox>

            <!-- Efectivo -->
            <VBox alignment="CENTER" spacing="3">
                <Label styleClass="counter-label" text="Efectivo" />
                <Label fx:id="cashTotalLabel" styleClass="counter-value cash-counter" />
            </VBox>

            <!-- Transferencia -->
            <VBox alignment="CENTER" spacing="3">
                <Label styleClass="counter-label" text="Transferencia" />
                <Label fx:id="transferTotalLabel" styleClass="counter-value transfer-counter" />
            </VBox>

            <!-- Delivery -->
            <VBox alignment="CENTER" spacing="3">
                <Label styleClass="counter-label" text="Delivery" />
                <Label fx:id="deliveryTotalLabel" styleClass="counter-value delivery-counter" />
            </VBox>

            <Region HBox.hgrow="ALWAYS" />

            <Button fx:id="closeCashBtn" onAction="#closeCash" styleClass="close-cash-btn" text="Cerrar Caja" />
        </HBox>
    </VBox>

</AnchorPane>
